See http://wiki.call-cc.org/egg/http-session